"use strict";var Z=Object.create;var I=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var ne=(l,r)=>{for(var e in r)I(l,e,{get:r[e],enumerable:!0})},W=(l,r,e,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of te(r))!se.call(l,s)&&s!==e&&I(l,s,{get:()=>r[s],enumerable:!(t=ee(r,s))||t.enumerable});return l};var A=(l,r,e)=>(e=l!=null?Z(re(l)):{},W(r||!l||!l.__esModule?I(e,"default",{value:l,enumerable:!0}):e,l)),ae=l=>W(I({},"__esModule",{value:!0}),l);var _e={};ne(_e,{MapleUtilsParser:()=>$,NotFoundError:()=>h,NotValidHtmlNodeError:()=>T,NotValidSpecPageError:()=>d,OpenPageError:()=>f,PrivateInformationError:()=>_,RankingSearchError:()=>v,RetryError:()=>E});module.exports=ae(_e);var u="https://maplestory.nexon.com",O=`${u}/Ranking/World/Total`;var d=class extends Error{constructor(){super("\uC62C\uBC14\uB978 \uCE90\uB9AD\uD130 \uC815\uBCF4 \uD398\uC774\uC9C0\uAC00 \uC544\uB2D9\uB2C8\uB2E4"),this.name="InvalidSpecPageError"}};var f=class extends Error{constructor(r){super(`${r} \uD398\uC774\uC9C0 \uC5F4\uAE30 \uC624\uB958`),this.name="OpenPageError"}};var _=class extends Error{constructor(r){super(`\uCE90\uB9AD\uD130 \uC815\uBCF4\uAC00 \uBE44\uACF5\uAC1C\uC785\uB2C8\uB2E4${r?` (${r})`:""}`),this.name="PrivateInformationError"}};var E=class extends Error{constructor(r){super(`${r} \uC7AC\uC2DC\uB3C4\uB97C \uC2E4\uD328 \uD588\uC2B5\uB2C8\uB2E4`),this.name="RetryError"}};var v=class extends Error{constructor(e){super(`'${e}' \uACF5\uC2DD \uD648\uD398\uC774\uC9C0 \uB7AD\uD0B9 \uAC80\uC0C9 \uC624\uB958`);this.characterName=e;this.name="RankingSearchError"}};var h=class extends Error{constructor(r){super(`\uCE90\uB9AD\uD130 ${r}\uC744(\uB97C) \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4`),this.name="NotFoundError"}};var T=class extends Error{constructor(e,t){super("\uC62C\uBC14\uB978 HTML \uB178\uB4DC\uAC00 \uC544\uB2D9\uB2C8\uB2E4");this.node=e;this.selector=t;this.name="NotValidHtmlNodeError"}};var H=A(require("node-html-parser"));var D={\uB808\uC5B4\uC544\uC774\uD15C:"rare",\uC5D0\uD53D\uC544\uC774\uD15C:"epic",\uC720\uB2C8\uD06C\uC544\uC774\uD15C:"unique",\uB808\uC804\uB4DC\uB9AC\uC544\uC774\uD15C:"legendary",\uC2A4\uD398\uC15C\uC544\uC774\uD15C:"special",\uB808\uC5B4:"rare",\uC5D0\uD53D:"epic",\uC720\uB2C8\uD06C:"unique",\uB808\uC804\uB4DC\uB9AC:"legendary",\uC2A4\uD398\uC15C:"special"};var x={STR:"str",DEX:"dex",INT:"int",LUK:"luk",\uD798:"str",\uBBFC\uCCA9:"dex",\uBBFC\uCCA9\uC131:"dex",\uC9C0\uB825:"int",\uC6B4:"luk",\uD589\uC6B4:"luk",MaxHP:"hp","\uCD5C\uB300 HP":"hp",MaxMP:"mp","\uCD5C\uB300 MP":"mp","STR%":"strP","DEX%":"dexP","INT%":"intP","LUK%":"lukP","MaxHP%":"hpP","\uCD5C\uB300 HP%":"hpP","MaxMP%":"mpP","\uCD5C\uB300 MP%":"mpP",\uACF5\uACA9\uB825:"atk",\uB9C8\uB825:"mAtk","\uACF5\uACA9\uB825%":"atkP","\uB9C8\uB825%":"mAtkP",\uBB3C\uB9AC\uBC29\uC5B4\uB825:"def",\uBC29\uC5B4\uB825:"def","\uBB3C\uB9AC\uBC29\uC5B4\uB825%":"defP","\uBC29\uC5B4\uB825%":"defP",\uC774\uB3D9\uC18D\uB3C4:"speed",\uC810\uD504\uB825:"jump","\uBAAC\uC2A4\uD130 \uBC29\uC5B4\uB825 \uBB34\uC2DC":"ignoreDef","\uBAAC\uC2A4\uD130 \uBC29\uC5B4\uB825 \uBB34\uC2DC%":"ignoreDef","\uBAAC\uC2A4\uD130 \uBC29\uC5B4\uC728 \uBB34\uC2DC":"ignoreDef","\uBAAC\uC2A4\uD130 \uBC29\uC5B4\uC728 \uBB34\uC2DC%":"ignoreDef","\uBCF4\uC2A4 \uBAAC\uC2A4\uD130\uACF5\uACA9 \uC2DC \uB370\uBBF8\uC9C0":"bossDmg","\uBCF4\uC2A4 \uBAAC\uC2A4\uD130 \uACF5\uACA9 \uC2DC \uB370\uBBF8\uC9C0":"bossDmg","\uBCF4\uC2A4 \uBAAC\uC2A4\uD130 \uACF5\uACA9 \uC2DC \uB370\uBBF8\uC9C0%":"bossDmg",\uB370\uBBF8\uC9C0:"dmg","\uB370\uBBF8\uC9C0%":"dmg",\uC62C\uC2A4\uD0EF:"allStat","\uC62C\uC2A4\uD0EF%":"allStatP","\uD06C\uB9AC\uD2F0\uCEEC \uD655\uB960":"crit","\uD06C\uB9AC\uD2F0\uCEEC \uD655\uB960%":"crit","\uD06C\uB9AC\uD2F0\uCEEC \uB370\uBBF8\uC9C0":"critDmg","\uD06C\uB9AC\uD2F0\uCEEC \uB370\uBBF8\uC9C0%":"critDmg","\uCE90\uB9AD\uD130 \uAE30\uC900 9\uB808\uBCA8 \uB2F9 STR":"lv9Str","\uCE90\uB9AD\uD130 \uAE30\uC900 9\uB808\uBCA8 \uB2F9 DEX":"lv9Dex","\uCE90\uB9AD\uD130 \uAE30\uC900 9\uB808\uBCA8 \uB2F9 INT":"lv9Int","\uCE90\uB9AD\uD130 \uAE30\uC900 9\uB808\uBCA8 \uB2F9 LUK":"lv9Luk","\uBA54\uC18C \uD68D\uB4DD\uB7C9":"meso","\uBA54\uC18C \uD68D\uB4DD\uB7C9%":"meso","\uC544\uC774\uD15C \uB4DC\uB86D\uB960":"drop","\uC544\uC774\uD15C \uB4DC\uB86D\uB960%":"drop","HP \uD68C\uBCF5 \uC544\uC774\uD15C \uBC0F \uD68C\uBCF5 \uC2A4\uD0AC \uD6A8\uC728":"hpHeal","HP \uD68C\uBCF5 \uC544\uC774\uD15C \uBC0F \uD68C\uBCF5 \uC2A4\uD0AC \uD6A8\uC728%":"hpHeal"};var U="div.item_memo_title > h1",ie="div.item_img > img",oe="div.item_ability > div:nth-child(3) > span > em",le="div.item_ability > div:nth-child(1) > ul > li:nth-child(1) > em",K="div.stet_info > ul > li",ce="div.item_title > div.item_memo > div.item_memo_sel",N=class{parseBase(r){let e=H.default.parse(r),{name:t,upgrade:s,star:i}=this.parseName(e,r),n=this.parseLevel(e),a=this.parseImage(e),o=this.parseCategory(e),{base:c,scroll:m,flame:g,potential:P,additional:S,soul:w,scissors:y}=this.parseOptions(e),q=this.parseGrade(e);return{name:t,level:n,imageUrl:a,category:o,upgrade:s,base:c,scroll:m,grade:q,star:i,potential:P,additional:S,flame:g,soul:w,scissors:y}}parseCash(r){let e=H.default.parse(r),{name:t,upgrade:s}=this.parseName(e,r),i=this.parseImage(e),n=this.parseCategory(e),{base:a,scroll:o}=this.parseOptions(e);return{name:t,upgrade:s,imageUrl:i,category:n,scroll:o,base:a}}parseSymbol(r){let e=H.default.parse(r),{name:t}=this.parseName(e,r),{scroll:s}=this.parseOptions(e),i=this.parseSymbolOptions(e);return{name:t,stat:s,...i}}parseSymbolOptions(r){let[e,t]=r.querySelectorAll(K),s=e.querySelector("div.point_td")?.text||"0",i=t.querySelector("div.point_td")?.text,[n,a]=i?.split("/")||["0","0"];return{level:parseInt(s),experience:parseInt(n),requiredExperience:parseInt(a)}}parseLevel(r){return Number.parseInt(r.querySelector(le)?.text.trim()??"0")}parseOptions(r){let e=r.querySelectorAll(K),t={base:{},scroll:{},flame:{}};for(let s of e){let i=s.querySelector("div.stet_th"),n=i.text.trim();if(!n||n==="\uACF5\uACA9\uC18D\uB3C4"||n==="\uAE30\uD0C0")continue;let a=s.querySelector("div.point_td");if(n.startsWith("\uC7A0\uC7AC")){t.potential=this.parsePotential(i,a);continue}if(n.startsWith("\uC5D0\uB514")){t.additional=this.parsePotential(i,a);continue}if(n.startsWith("\uC18C\uC6B8")){t.soul=this.parseSoul(a);continue}if(n.startsWith("\uAC00\uC704 \uC0AC\uC6A9")){t.scissors=parseInt(a.text.trim());continue}if(n.startsWith("Max")&&a.text.includes("%")){let o=n==="MaxHP"?"hpP":"mpP";t.base[o]=parseInt(a.text.trim());continue}if(n.startsWith("\uC62C")&&a.text.includes("%")){let{base:o,scroll:c,flame:m}=this.parseStat(n,a);t.base.allStatP=o[1],t.scroll.allStatP=c[1],t.flame.allStatP=m[1];continue}if(x[n]){let{base:o,scroll:c,flame:m}=this.parseStat(n,a);t.base[o[0]]=o[1],t.scroll[c[0]]=c[1],t.flame[m[0]]=m[1]}}return t}parseGrade(r){let e=r.querySelector(ce)?.text.trim();return e&&D[e]||"nothing"}parseStat(r,e){let t=x[r],s=e.innerText.trim(),i=s.indexOf("(");if(i<0)return{base:[t,parseInt(s)],scroll:[t,void 0],flame:[t,void 0]};let[n,a,o]=s.substring(i+1,s.length-1).split("+").map(c=>parseInt(c.trim()));return{base:[t,n||void 0],scroll:[t,o||void 0],flame:[t,a||void 0]}}parseSoul(r){let e=r.childNodes[2];if(!e)return;let t=e.text.split(":").map(a=>a.trim());if(t.length!==2)return;let[s,i]=t,n=x[s];if(n)return{[n]:parseInt(i)}}parsePotential(r,e){let t=r.querySelector("font")?.text;if(!t)return;let s=e.childNodes.filter((i,n)=>n%2===0).map(i=>{let[n,a]=i.text.split(":"),o=n.trim()+(a?.includes("%")?"%":""),c=x[o];return c?{[c]:parseInt(a)}:null}).filter(i=>i);return{grade:D[t]||"nothing",effects:s}}parseCategory(r){return r.querySelector(oe)?.text?.trim()||""}parseImage(r){return r.querySelector(ie)?.attrs.src||""}parseName(r,e){let t=r.querySelector(U);if(!t)throw console.log(e),new T(r,U);t.childNodes.length>3&&(t.childNodes.shift(),t.childNodes.shift(),t.childNodes.shift());let[i,n]=t.childNodes,[a,o]=i.text.replaceAll("&nbsp;","").split("(+");return{name:a.trim(),upgrade:parseInt(o?.trim()||"0"),star:parseInt(n?.text.trim()||"0")}}};var j=A(require("node-html-parser"));var pe="div.con_wrap > div.contents_wrap > div > div.tab01_con_wrap > table:nth-child(2) > tbody > tr > td",me="div.char_info_top > div.char_name > span",ue="div.char_info_top > div.char_info > dl:nth-child(1) > dd",de="div.char_info_top > div.char_info > div.char_img > div > img",he="div.con_wrap > div.contents_wrap > div > div.tab02_con_wrap > div > ul > li > div > div.graph_wrap > div > span",M=class{parse(r){let e=j.default.parse(r),t=e.querySelectorAll(pe);if(!t||t.length!==6)throw new d;let[s,i,n,a]=t.map(o=>o.text.replaceAll(",","").trim());return{name:this.parseName(e),world:s,guild:a,job:i.split("/")[1].trim(),level:this.parseLevel(e),imageUrl:this.parseImageUrl(e),traits:this.parseTraits(e)}}parseName(r){let e=r.querySelector(me)?.text;if(!e)throw new h("\uC774\uB984");return e.substring(0,e.length-1)}parseLevel(r){let e=r.querySelector(ue)?.text.replace(/[^\d]/g,"");if(!e)throw new h("\uB808\uBCA8");return parseInt(e)}parseImageUrl(r){let e=r.querySelector(de)?.attrs.src;if(!e)throw new h("\uC774\uBBF8\uC9C0");return e}parseTraits(r){let e=r.querySelectorAll(he);if(e.length!==6)throw new h("\uC131\uD5A5");let[t,s,i,n,a,o]=e.map(c=>parseInt(c.text));return{ambition:t,insight:s,willpower:i,diligence:n,empathy:a,charm:o}}};var L=A(require("node-html-parser"));var ge="div.rank_table_wrap > table > tbody > tr > td.left > dl > dt > a",fe="#container > div.con_wrap > div.lnb_wrap > ul > li:nth-child(3) > a",Ee="#container > div.con_wrap > div.lnb_wrap > ul > li:nth-child(10) > a",Pe="#container > div.con_wrap > div.contents_wrap > div > div.tab01_con_wrap > div.weapon_wrap > ul > li a",Se="#container > div.con_wrap > div.contents_wrap > div > div.tab02_con_wrap > div.cash_weapon_wrap > ul > li a",be="#container > div.con_wrap > div.contents_wrap > div > div.tab03_con_wrap > div.arcane_weapon_wrap > ul > li a",ve="#container > div.con_wrap > div.contents_wrap > div > div.tab02_con_wrap > div > ul > li > h2 > span > a",k=class{getCharacterLink(r,e){let i=L.default.parse(e).querySelectorAll(ge).find(n=>n.innerText.toLowerCase()===r.toLowerCase());if(!i)throw new h(r);return`${u}${i.attrs.href}`}ensureIsPublic(r,e){if(L.default.parse(r).querySelector("div.private2"))throw new _(e)}getEquipmentPageLink(r){let t=L.default.parse(r).querySelector(fe);if(!t)throw new d;return`${u}${t.attrs.href}`}getPetPageLink(r){let t=L.default.parse(r).querySelector(Ee);if(!t)throw new d;return`${u}${t.attrs.href}`}getEquipmentLinks(r){let e=L.default.parse(r),t=e.querySelectorAll(Pe),s=e.querySelectorAll(Se),i=e.querySelectorAll(be);return{base:t.map(n=>`${u}${n.attrs.href}`).filter(n=>n!==u),cash:s.map(n=>`${u}${n.attrs.href}`).filter(n=>n!==u),symbol:i.map(n=>`${u}${n.attrs.href}`).filter(n=>n!==u)}}getPetEquipmentLinks(r){return L.default.parse(r).querySelectorAll(ve).map(s=>`${u}${s.attrs.href}`).filter(s=>s!==u)}};var B=A(require("node-html-parser")),Le="div.con_wrap > div.contents_wrap > div > div.tab01_con_wrap > table:nth-child(4) > tbody > tr > td",C=class{parse(r){let t=B.default.parse(r).querySelectorAll(Le);if(!t||t.length!==20)throw new d;let[s,i,n,a,o,c,m,g,P,S,w,y,q,p,b,F,Te,V,Y,Q]=t.map(R=>R.childNodes[0].childNodes.length>1?R.childNodes[0].childNodes.filter((G,J)=>J%2===0).map(G=>G.text).join(`
`):R.text.replaceAll(",","").trim()),[X,z]=s.split(" ~ ");return{statAtkLow:parseInt(X.trim()),statAtkHigh:parseInt(z.trim()),hp:parseInt(i),mp:parseInt(n),str:parseInt(a),dex:parseInt(o),int:parseInt(c),luk:parseInt(m),critDmg:parseInt(g),bossDmg:parseInt(P),ignoreDef:parseInt(S),resistance:parseInt(w),stance:parseInt(y),def:parseInt(q),speed:parseInt(p),jump:parseInt(b),starForce:parseInt(F),arcaneForce:parseInt(V),hypers:this.parseHypers(Q),abilities:this.parseAbilities(Y)}}parseHypers(r){let e={};return r.split(`
`).forEach(t=>{let s=parseInt(t.replace(/[^\d]/g,""));t.startsWith("\uD798")?e.str=s:t.startsWith("\uBBFC\uCCA9\uC131")?e.dex=s:t.startsWith("\uC9C0\uB825")?e.int=s:t.startsWith("\uC6B4")?e.luk=s:t.startsWith("\uCD5C\uB300 HP")?e.hpP=s:t.startsWith("\uD06C\uB9AC\uD2F0\uCEEC \uD655\uB960")?e.crit=s:t.startsWith("\uD06C\uB9AC\uD2F0\uCEEC \uB370\uBBF8\uC9C0")?e.critDmg=s:t.startsWith("\uACF5\uACA9\uB825")?(e.atk=s,e.mAtk=s):t.startsWith("\uBCF4\uC2A4")?e.bossDmg=s:t.startsWith("\uC77C\uBC18")?e.mobDmg=s:t.startsWith("\uB370\uBBF8\uC9C0")?e.dmg=s:t.startsWith("\uBC29\uC5B4\uC728")?e.ignoreDef=s:t.startsWith("\uC544\uCF00\uC778")?e.arcane=s:t.startsWith("\uD68D\uB4DD \uACBD\uD5D8\uCE58")&&(e.exp=s/10)}),e}parseAbilities(r){let e={};return r.split(`
`).forEach(t=>{let s=parseInt(t.replace(/[^\d]/g,""));if(t.includes("\uD328\uC2DC\uBE0C"))e.passive=1;else if(t.includes("\uBCF4\uC2A4"))e.bossDmg=s;else if(t.includes("\uB808\uBCA8\uB9C8\uB2E4 \uACF5\uACA9\uB825"))e.lvNAtk=s;else if(t.includes("\uB808\uBCA8\uB9C8\uB2E4 \uB9C8\uB825"))e.lvNmAtk=s;else if(t.includes("\uC7AC\uC0AC\uC6A9 \uB300\uAE30\uC2DC\uAC04"))e.reuse=s;else if(!t.includes("AP"))if(t.includes("\uACF5\uACA9\uB825"))e.atk=s;else if(t.includes("\uB9C8\uB825"))e.mAtk=s;else if(t.includes("\uD06C\uB9AC"))e.crit=s;else if(t.includes("\uCD5C\uB300 HP"))t.includes("%")?e.hpP=s:e.hp=s;else if(t.includes("\uBAA8\uB4E0 \uB2A5\uB825\uCE58"))e.allStat=s;else if(t.includes("\uC0C1\uD0DC \uC774\uC0C1\uC5D0"))e.statusDmg=s;else if(t.includes("\uBC84\uD504"))e.buff=s;else if(t.includes("\uBA54\uC18C"))e.meso=s;else if(t.includes("\uC544\uC774\uD15C"))e.drop=s;else for(let i of["str","dex","int","luk"])t.split(",").forEach(n=>{if(n.includes(i.toUpperCase())){let a=parseInt(n.replace(/[^\d]/g,""));e[i]=(e[i]||0)+a}})}),e}};var $=class l{constructor(r,e,t,s){this.homePageParser=r,this.equipmentParser=e,this.specParser=t,this.generalInformationParser=s}static new(){let r=new k,e=new N,t=new C,s=new M;return new l(r,e,t,s)}async getCharacterInfo({name:r,cash:e,pet:t,equip:s,symbol:i}){console.log(`${r} --> ranking search`);let n=await this.getCharacterLink(r);console.log(`${r} --> character page`);let a=await this.getSpecPage(n),o=this.specParser.parse(a),c=this.generalInformationParser.parse(a),m=this.homePageParser.getEquipmentPageLink(a),g=this.homePageParser.getPetPageLink(a);console.log(`${r} --> equipments`);let[P,S]=await Promise.all([this.getEquipments(m,s,e,i),t?this.getPetEquipments(g):void 0]);return{spec:o,generalInformation:c,equipments:P,petEquipments:S}}async getCharacter({name:r,cash:e=!0,pet:t=!0,equip:s=!0,symbol:i=!0}){let{spec:n,generalInformation:a,equipments:o,petEquipments:c}=await this.getCharacterInfo({name:r,cash:e,pet:t,equip:s,symbol:i});return{...a,spec:n,equipments:o?.success.base,arcanes:o?.success.symbol,cashEquipments:o?.success.cash,petEquipments:c?.success}}async getCharacterWithErrors({name:r,cash:e=!0,pet:t=!0,equip:s=!0,symbol:i=!0}){let{spec:n,generalInformation:a,equipments:o,petEquipments:c}=await this.getCharacterInfo({name:r,cash:e,pet:t,equip:s,symbol:i}),m=[o?.error?.base,o?.error?.symbol,o?.error?.cash,c?.error].some(g=>!!g);return{data:{...a,spec:n,equipments:o?.success.base,arcanes:o?.success.symbol,cashEquipments:o?.success.cash,petEquipments:c?.success},errors:m?{equipments:o?.error?.base,arcanes:o?.error?.symbol,cashEquipments:o?.error?.cash,petEquipments:c?.error}:void 0}}async getCharacterLink(r){let e=await fetch(`${O}?c=${encodeURI(r)}`);if(e.status!==200)throw new v(r);let t=await e.text(),s="";try{s=this.homePageParser.getCharacterLink(r,t)}catch{let n=await fetch(`${O}?c=${encodeURI(r)}&w=254`);if(e.status!==200)throw new v(r);let a=await n.text();s=this.homePageParser.getCharacterLink(r,a)}return s}async getSpecPage(r){let e=await fetch(r);if(e.status!==200)throw new f("\uCE90\uB9AD\uD130 \uC815\uBCF4");let t=await e.text();return this.homePageParser.ensureIsPublic(t,"\uAE30\uBCF8 \uC815\uBCF4"),t}async getEquipments(r,e,t,s){let i=await fetch(r);if(i.status!==200)throw new f("\uC7A5\uBE44");let n=await i.text();this.homePageParser.ensureIsPublic(n,"\uC7A5\uBE44");let a=this.homePageParser.getEquipmentLinks(n),[o,c,m]=await Promise.all([e?this.getAllHtmls(a.base):void 0,t?this.getAllHtmls(a.cash):void 0,s?this.getAllHtmls(a.symbol):void 0]),g=o?.error,P=c?.error,S=m?.error,w=o?.success?.map(p=>this.equipmentParser.parseBase(p)).filter(p=>!!p),y=c?.success?.map(p=>this.equipmentParser.parseCash(p)).filter(p=>!!p),q=m?.success?.map(p=>this.equipmentParser.parseSymbol(p)).filter(p=>!!p);return{success:{base:w,cash:y,symbol:q},error:{base:g?.length?()=>this.getAllHtmls(g).then(({success:p,error:b})=>{if(b.length)throw new E("\uC77C\uBC18\uC7A5\uBE44");return p.map(this.equipmentParser.parseBase)}):void 0,cash:P?.length?()=>this.getAllHtmls(P).then(({success:p,error:b})=>{if(b.length)throw new E("\uCE90\uC2DC\uC7A5\uBE44");return p.map(this.equipmentParser.parseCash)}):void 0,symbol:S?.length?()=>this.getAllHtmls(S).then(({success:p,error:b})=>{if(b.length)throw new E("\uC2EC\uBCFC");return p.map(this.equipmentParser.parseSymbol)}):void 0}}}async getPetEquipments(r){let e=await fetch(r);if(e.status!==200)throw new f("\uD3AB\uC7A5\uBE44");let t=await e.text();this.homePageParser.ensureIsPublic(t,"\uD3AB");let s=this.homePageParser.getPetEquipmentLinks(t),i=await this.getAllHtmls(s);return{success:i.success.map(n=>this.equipmentParser.parseCash(n)).filter(n=>!!n),error:i.error?.length?()=>this.getAllHtmls(i.error).then(({success:n,error:a})=>{if(a.length)throw new E("\uD3AB\uC7A5\uBE44");return n.map(this.equipmentParser.parseCash)}):void 0}}async getAllHtmls(r){let e=r,t=[],s=0;for(;e.length>0&&s<5;){s&&(console.log(`\uC2DC\uB3C4 \uD69F\uC218: ${s}, \uB0A8\uC740 \uB9C1\uD06C \uC218: ${e.length} ${s}\uCD08\uD6C4 \uC7AC\uC2DC\uB3C4`),await new Promise(n=>setTimeout(n,1e3*s)));let i=e.map(n=>fetch(n,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(a=>{if(a.status!==200)throw console.log(`'${n}' \uC815\uBCF4\uB97C \uAC00\uC838\uC624\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4`,a.status),new f(n);return a.json()}).then(a=>{a.view&&(t.push(a.view),e.splice(e.indexOf(n),1))}));await Promise.allSettled(i),s++}return{success:t,error:e}}};0&&(module.exports={MapleUtilsParser,NotFoundError,NotValidHtmlNodeError,NotValidSpecPageError,OpenPageError,PrivateInformationError,RankingSearchError,RetryError});
//# sourceMappingURL=index.js.map